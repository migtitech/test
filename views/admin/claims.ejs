<%- include('../partials/header') %>

<h1>Claim Requests</h1>

<div class="card">
  <% if (claims.length === 0) { %>
    <p class="text-muted">No claim requests.</p>
  <% } %>
  <% claims.forEach(c => { %>
  <div class="submission-item">
    <div class="submission-header">
      <div>
        <strong><%= c.user ? c.user.name : 'Deleted User' %></strong>
        <span class="text-muted"> requested </span>
        <strong><%= c.amount %> points</strong>
      </div>
      <span class="badge badge-<%= c.status %>"><%= c.status %></span>
    </div>
    <p><%= c.description %></p>
    <div class="submission-meta">
      <small><%= c.createdAt.toLocaleString() %></small>
      <% if (c.status === 'pending') { %>
      <div>
        <form method="POST" action="/admin/claims/approve/<%= c._id %>" style="display:inline">
          <button type="submit" class="btn btn-success btn-sm">Approve & Deduct</button>
        </form>
        <form method="POST" action="/admin/claims/reject/<%= c._id %>" style="display:inline">
          <button type="submit" class="btn btn-danger btn-sm">Reject</button>
        </form>
      </div>
      <% } %>
    </div>
  </div>
  <% }) %>
  <%- include('../partials/pagination') %>
</div>

<%- include('../partials/footer') %>
